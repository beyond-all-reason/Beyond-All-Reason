
#include "../recoil_common_includes.h"

piece
    thruster1,
    base,
    thruster1XPivot,
    thruster2,
    thruster2XPivot,
    wing1,
    wing2,
    centralThruster,
    riotSleeve1,
    riotBarrel1,
    riotSleeve2,
    riotBarrel2,
    riotFlare1,
    riotFlare2,
    smallthrust2,
    smallthrust1,
    mainThrust
;

static-var  whichBarrel;


#define BASEPIECE base
#define HITSPEED <105.0>
//how 'heavy' the unit is, on a scale of 1-10
#define UNITSIZE 2
#define MAXTILT 100

#include "../unit_hitbyweaponid_and_smoke.h"

#define IDLEHOVERSCALE 32
#define IDLEHOVERSPEED 60
#define IDLEBASEPIECE base
#include "../idlehover.h"

Create()
{
    hide smallthrust1;
    hide smallthrust2;
    hide mainThrust;

    turn smallthrust1 to x-axis <-90> now;
    turn smallthrust2 to x-axis <-90> now;

    turn thruster1XPivot to z-axis <-20> now;
    turn thruster2XPivot to z-axis <20> now;
    turn wing1 to z-axis <-25> now;
    turn wing2 to z-axis <25> now;

	whichBarrel = 0;
	SLEEP_UNTIL_UNITFINISHED;
	start-script IdleHover();
}

Activate()
{
    show smallThrust1;
    show smallThrust2;
    turn wing1 to z-axis <0> speed <30>;
    turn wing2 to z-axis <0> speed <30>;
    wait-for-turn wing2 around z-axis;
    show mainThrust;
}

Deactivate()
{
    hide mainThrust;
    turn wing1 to z-axis <-25> speed <30>;
    turn wing2 to z-axis <25> speed <30>;
    wait-for-turn wing2 around z-axis;
    hide smallthrust1;
    hide smallthrust2;
}

MoveRate3()
{
	turn thruster1XPivot to x-axis <90> speed <45>;
    turn thruster2XPivot to x-axis <90> speed <45>;

}

MoveRate2()
{
	turn thruster1XPivot to x-axis <90> speed <60>;
    turn thruster2XPivot to x-axis <90> speed <60>;
}

MoveRate1()
{
	turn thruster1XPivot to x-axis <50> speed <90>;
    turn thruster2XPivot to x-axis <50> speed <90>;

}

MoveRate0()
{
	turn thruster1XPivot to x-axis <0> speed <150>;
    turn thruster2XPivot to x-axis <0> speed <150>;
}

AimWeapon1(heading, pitch)
{
	return (1);
}

FireWeapon1()
{
    if(whichBarrel == 0){
        emit-sfx 1024 + 0 from riotFlare1;
        move riotBarrel1 to z-axis [-3] now;
        sleep 10;
        move riotBarrel1 to z-axis [0] speed [3];
    } 
    else if(whichBarrel == 1){
        emit-sfx 1024 + 0 from riotFlare2;
        move riotBarrel2 to z-axis [-3] now;
        sleep 10;
        move riotBarrel2 to z-axis [0] speed [3];
    } 
	whichBarrel = !whichBarrel;
}

AimFromWeapon1(pieceIndex)
{
	pieceIndex = base;
}

QueryWeapon1(pieceIndex)
{
    if(whichBarrel == 0) pieceIndex = riotFlare1;
    else if(whichBarrel == 1) pieceIndex = riotFlare2;
}


Killed(severity, corpsetype)
{
	if( severity <= 25 )
	{
		corpsetype = 1 ;
		explode base type BITMAPONLY | NOHEATCLOUD;
		// explode flare2 type BITMAPONLY | NOHEATCLOUD;
		// explode flare1 type BITMAPONLY | NOHEATCLOUD;
		// explode fan type FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode finr type BITMAPONLY | NOHEATCLOUD;
		// explode finl type BITMAPONLY | NOHEATCLOUD;
		// explode wingr type BITMAPONLY | NOHEATCLOUD;
		// explode wingl type BITMAPONLY | NOHEATCLOUD;
		return(corpsetype);
	}
	if( severity <= 50 )
	{
		corpsetype = 2 ;
		explode base type BITMAPONLY | NOHEATCLOUD;
		// explode flare2 type BITMAPONLY | NOHEATCLOUD;
		// explode flare1 type BITMAPONLY | NOHEATCLOUD;
		// explode fan type FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode finr type BITMAPONLY | NOHEATCLOUD;
		// explode finl type FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode wingr type FALL | NOHEATCLOUD;
		// explode wingl type FALL | NOHEATCLOUD;
		return(corpsetype);
	}
	if( severity <= 99 )
	{
		corpsetype = 3 ;
		explode base type BITMAPONLY | NOHEATCLOUD;
		// explode flare2 type BITMAPONLY | NOHEATCLOUD;
		// explode flare1 type BITMAPONLY | NOHEATCLOUD;
		// explode fan type FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode finr type BITMAPONLY | NOHEATCLOUD;
		// explode finl type EXPLODE_ON_HIT | FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode wingr type FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode wingl type EXPLODE_ON_HIT | FIRE | SMOKE | FALL | NOHEATCLOUD;
		return(corpsetype);
	}
	corpsetype = 3 ;
		explode base type BITMAPONLY | NOHEATCLOUD;
		// explode flare2 type BITMAPONLY | NOHEATCLOUD;
		// explode flare1 type BITMAPONLY | NOHEATCLOUD;
		// explode fan type EXPLODE_ON_HIT | FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode finr type BITMAPONLY | NOHEATCLOUD;
		// explode finl type EXPLODE_ON_HIT | FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode wingr type EXPLODE_ON_HIT | FIRE | SMOKE | FALL | NOHEATCLOUD;
		// explode wingl type EXPLODE_ON_HIT | FIRE | FALL | NOHEATCLOUD;
	return corpsetype;
}
